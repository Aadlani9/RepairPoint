# RepairPoint - Uploads Directory Protection
# حماية مجلد الملفات المرفوعة

# منع تنفيذ ملفات PHP في مجلد الرفع
<Files "*.php">
    Order Deny,Allow
    Deny from all
</Files>

<Files "*.php3">
    Order Deny,Allow
    Deny from all
</Files>

<Files "*.php4">
    Order Deny,Allow
    Deny from all
</Files>

<Files "*.php5">
    Order Deny,Allow
    Deny from all
</Files>

<Files "*.phtml">
    Order Deny,Allow
    Deny from all
</Files>

<Files "*.pl">
    Order Deny,Allow
    Deny from all
</Files>

<Files "*.py">
    Order Deny,Allow
    Deny from all
</Files>

<Files "*.jsp">
    Order Deny,Allow
    Deny from all
</Files>

<Files "*.asp">
    Order Deny,Allow
    Deny from all
</Files>

<Files "*.sh">
    Order Deny,Allow
    Deny from all
</Files>

<Files "*.cgi">
    Order Deny,Allow
    Deny from all
</Files>

# السماح فقط لأنواع الملفات الآمنة
<FilesMatch "\.(jpg|jpeg|png|gif|pdf|doc|docx|txt|zip)$">
    Order Allow,Deny
    Allow from all
</FilesMatch>

# منع الوصول للملفات الخطيرة
<FilesMatch "\.(htaccess|htpasswd|ini|log|sh|inc|bak|exe|bat|cmd)$">
    Order Allow,Deny
    Deny from all
</FilesMatch>

# رسالة خطأ مخصصة
ErrorDocument 403 "Access Denied - Executable files are not allowed"